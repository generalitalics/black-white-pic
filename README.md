# black-white-pic

–ú–∏–Ω–∏-–ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ –Ω–∞ Python, –∫–æ—Ç–æ—Ä–æ–µ:
- –∑–∞–±–∏—Ä–∞–µ—Ç —Å–ª—É—á–∞–π–Ω—É—é –∫–∞—Ä—Ç–∏–Ω–∫—É –∏–∑ –ø—É–±–ª–∏—á–Ω–æ–≥–æ –¥–∞—Ç–∞—Å–µ—Ç–∞ Google QuickDraw (–±–µ–∑ —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏–∏),
- –ø–æ–ª—É—á–∞–µ—Ç –≤–º–µ—Å—Ç–µ —Å –∫–∞—Ä—Ç–∏–Ω–∫–æ–π —Å–ª–æ–≤–æ-–º–µ—Ç–∫—É (—á—Ç–æ –Ω–∞—Ä–∏—Å–æ–≤–∞–Ω–æ),
- —É–ø—Ä–æ—â–∞–µ—Ç –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ –¥–æ —á—ë—Ä–Ω–æ-–±–µ–ª–æ–π –º–∞—Ç—Ä–∏—Ü—ã 7√ó7 –∏–∑ 0 –∏ 1, –≥–¥–µ 1 ‚Äî –∑–∞–∫—Ä–∞—à–µ–Ω–Ω—ã–π (—á—ë—Ä–Ω—ã–π) –ø–∏–∫—Å–µ–ª—å, 0 ‚Äî –ø—É—Å—Ç–æ–π.

–ò—Å—Ç–æ—á–Ω–∏–∫–∏ –¥–∞–Ω–Ω—ã—Ö (—Å—Ç–∞–±–∏–ª—å–Ω—ã–µ –ø—É–±–ª–∏—á–Ω—ã–µ URL):
- –°–ø–∏—Å–æ–∫ –∫–∞—Ç–µ–≥–æ—Ä–∏–π: `https://raw.githubusercontent.com/googlecreativelab/quickdraw-dataset/master/categories.txt`
- –ö–∞—Ä—Ç–∏–Ω–∫–∏ –≤ —Ñ–æ—Ä–º–∞—Ç–µ numpy (–ø–æ –∫–∞—Ç–µ–≥–æ—Ä–∏–∏): `https://storage.googleapis.com/quickdraw_dataset/full/numpy_bitmap/{label}.npy`
 - –≠–º–æ–¥–∑–∏ –∫–∞—Ç–∞–ª–æ–≥: `https://raw.githubusercontent.com/github/gemoji/master/db/emoji.json`
 - Twemoji PNG (–ø–æ unified-–∫–æ–¥—É): `https://cdn.jsdelivr.net/gh/twitter/twemoji@14.0.2/assets/72x72/{unified}.png`
 - Noto Emoji PNG (–ø–æ unified-–∫–æ–¥—É): `https://raw.githubusercontent.com/googlefonts/noto-emoji/main/png/128/emoji_u{unified_with_underscores}.png`

–ó–∞–≥—Ä—É–∑–∫–∞ –∏–¥—ë—Ç –Ω–∞–ø—Ä—è–º—É—é –ø–æ URL, –±–µ–∑ –∫–ª—é—á–µ–π/—Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏–∏. –í—ã–±–∏—Ä–∞–µ—Ç—Å—è —Å–ª—É—á–∞–π–Ω–∞—è –∫–∞—Ç–µ–≥–æ—Ä–∏—è –∏ —Å–ª—É—á–∞–π–Ω—ã–π –æ–±—Ä–∞–∑–µ—Ü.

## –£—Å—Ç–∞–Ω–æ–≤–∫–∞

```bash
python3 -m venv .venv
source .venv/bin/activate
pip install -r requirements.txt
```

## –ó–∞–ø—É—Å–∫

Emoji (–ø–æ —É–º–æ–ª—á–∞–Ω–∏—é):
```bash
python main.py --print-matrix --size 7x7 --source emoji --emoji-set twemoji
```

QuickDraw (—Å—Ç–∞—Ä—ã–π —Ä–µ–∂–∏–º):
```bash
python main.py --print-matrix --size 7x7 --source quickdraw
```

## HTTP –º–∏–∫—Ä–æ—Å–µ—Ä–≤–∏—Å

–ó–∞–ø—É—Å–∫ —Å–µ—Ä–≤–µ—Ä–∞:
```bash
uvicorn server:app --host 0.0.0.0 --port 8000
```

–ó–∞–ø—Ä–æ—Å:
```bash
curl "http://localhost:8000/nonogram/create?size=10x10"
```

–û—Ç–≤–µ—Ç JSON:
```json
{
  "emoji": "üôÇ",
  "label": "smile",
  "matrix": [[0,1,0,...],[...]]
}
```

–ü–∞—Ä–∞–º–µ—Ç—Ä—ã –∑–∞–ø—Ä–æ—Å–∞:
- `size` (–Ω–∞–ø—Ä–∏–º–µ—Ä `10x10`) ‚Äî —Ä–∞–∑–º–µ—Ä –≤—ã—Ö–æ–¥–Ω–æ–π –º–∞—Ç—Ä–∏—Ü—ã
- `emoji_set` (`twemoji`|`noto`, –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é `twemoji`)
- `label_mode` (`alias`|`emoji`, –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é `alias`)
- `method` (`avg`|`max`|`fraction`, –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é `fraction`)
- `fraction` (0..1, –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é 0.25)
- `threshold` (0..255, –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é 128)
- `threshold_mode` (`global`|`otsu`, –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é `otsu`)
- `autocontrast` (bool, –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é `true`)
- `gamma` (float, –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é 1.0)
- `blur` (float, –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é 0.4)
- `emoji_fetch_retries` (int, –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é 5)
- `emoji_catalog_url` (–ø–æ–≤—Ç–æ—Ä—è–µ–º—ã–π, —á—Ç–æ–±—ã –ø–µ—Ä–µ–æ–ø—Ä–µ–¥–µ–ª–∏—Ç—å URL –∫–∞—Ç–∞–ª–æ–≥–∞ —ç–º–æ–¥–∑–∏)
- `custom_emoji_url` (–ø–æ–≤—Ç–æ—Ä—è–µ–º—ã–π, —Å–æ–±—Å—Ç–≤–µ–Ω–Ω—ã–µ URL –∫–∞—Ä—Ç–∏–Ω–æ–∫)

### –ê—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—è

POST `/auth/login` ‚Äî –ø—Ä–æ–≤–µ—Ä–∫–∞ username –∏ password –≤ –ë–î:

```bash
curl -X POST "http://localhost:8000/auth/login" \
  -H "Content-Type: application/json" \
  -d '{"username": "player1", "password": "password123"}'
```

–£—Å–ø–µ—à–Ω—ã–π –æ—Ç–≤–µ—Ç (200):
```json
{
  "success": true,
  "user": {
    "id": 1,
    "username": "player1",
    "is_admin": true
  }
}
```

–û—à–∏–±–∫–∞ –ø—Ä–∏ –Ω–µ–≤–µ—Ä–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö (401):
```json
{
  "detail": "Invalid username or password"
}
```

**–ù–∞—Å—Ç—Ä–æ–π–∫–∞ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è –∫ –ë–î**: –ü–∞—Ä–∞–º–µ—Ç—Ä—ã –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è —Ö—Ä–∞–Ω—è—Ç—Å—è –≤ `db_config.py` –∏–ª–∏ –º–æ–≥—É—Ç –±—ã—Ç—å –ø–µ—Ä–µ–æ–ø—Ä–µ–¥–µ–ª–µ–Ω—ã —á–µ—Ä–µ–∑ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è:
- `DB_HOST` (–ø–æ —É–º–æ–ª—á–∞–Ω–∏—é: localhost)
- `DB_PORT` (–ø–æ —É–º–æ–ª—á–∞–Ω–∏—é: 5432)
- `DB_NAME` (–ø–æ —É–º–æ–ª—á–∞–Ω–∏—é: nonogram_db)
- `DB_USER` (–ø–æ —É–º–æ–ª—á–∞–Ω–∏—é: postgres)
- `DB_PASSWORD` (–ø–æ —É–º–æ–ª—á–∞–Ω–∏—é: –ø—É—Å—Ç–∞—è —Å—Ç—Ä–æ–∫–∞)

## –ë–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö PostgreSQL

–ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –ë–î:

```bash
# –°–æ–∑–¥–∞–π—Ç–µ –ë–î PostgreSQL
createdb nonogram_db

# –ü—Ä–∏–º–µ–Ω–∏—Ç–µ —Å–∫—Ä–∏–ø—Ç –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏–∏
psql -d nonogram_db -f init_db.sql
```

–ò–ª–∏ —Å —É–∫–∞–∑–∞–Ω–∏–µ–º –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –∏ —Ö–æ—Å—Ç–∞:
```bash
psql -h localhost -U postgres -d nonogram_db -f init_db.sql
```

–°–∫—Ä–∏–ø—Ç —Å–æ–∑–¥–∞—ë—Ç:
- **users** ‚Äî –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏ (2 –ø—Ä–∏–º–µ—Ä–∞: player1/password123, player2/secret456)
- **difficulty** ‚Äî —É—Ä–æ–≤–Ω–∏ —Å–ª–æ–∂–Ω–æ—Å—Ç–∏ (easy, medium, hard)
- **levels** ‚Äî —É—Ä–æ–≤–Ω–∏ –∏–≥—Ä—ã (5 easy, 10 medium, 15 hard)
- **user_progress** ‚Äî –ø—Ä–æ–≥—Ä–µ—Å—Å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π –ø–æ —É—Ä–æ–≤–Ω—è–º

**–í–∞–∂–Ω–æ**: –í –ø—Ä–æ–¥–∞–∫—à–µ–Ω–µ –ø–∞—Ä–æ–ª–∏ –¥–æ–ª–∂–Ω—ã –±—ã—Ç—å –∑–∞—Ö–µ—à–∏—Ä–æ–≤–∞–Ω—ã (–Ω–∞–ø—Ä–∏–º–µ—Ä, —Å –ø–æ–º–æ—â—å—é bcrypt). –í –ø—Ä–∏–º–µ—Ä–µ –∏—Å–ø–æ–ª—å–∑—É—é—Ç—Å—è plaintext –ø–∞—Ä–æ–ª–∏ —Ç–æ–ª—å–∫–æ –¥–ª—è —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è.

–ü—Ä–∏–º–µ—Ä –≤—ã–≤–æ–¥–∞:

```json
{"label": "cat", "matrix": [[0,0,0,1,0,0,0], [0,0,1,1,1,0,0], [0,1,0,1,0,1,0], [0,1,1,1,1,1,0], [0,0,0,1,0,0,0], [0,0,1,1,1,0,0], [0,1,0,0,0,1,0]]}

7x7 matrix:
0 0 0 1 0 0 0
0 0 1 1 1 0 0
0 1 0 1 0 1 0
0 1 1 1 1 1 0
0 0 0 1 0 0 0
0 0 1 1 1 0 0
0 1 0 0 0 1 0
```

## –û–ø—Ü–∏–∏

- `--size WIDTHxHEIGHT` (–ø–æ —É–º–æ–ª—á–∞–Ω–∏—é `7x7`): —Ä–∞–∑–º–µ—Ä –≤—ã—Ö–æ–¥–Ω–æ–π –º–∞—Ç—Ä–∏—Ü—ã, –Ω–∞–ø—Ä–∏–º–µ—Ä `10x12`.
- `--threshold` (–ø–æ —É–º–æ–ª—á–∞–Ω–∏—é 128): –ø–∏–∫—Å–µ–ª–∏ >= threshold —Å—á–∏—Ç–∞—é—Ç—Å—è —á—ë—Ä–Ω—ã–º–∏ (`1`).
- `--invert`: –∏–Ω–≤–µ—Ä—Ç–∏—Ä–æ–≤–∞—Ç—å —è—Ä–∫–æ—Å—Ç—å –ø–µ—Ä–µ–¥ –ø–æ—Ä–æ–≥–æ–º (–µ—Å–ª–∏ –∫–∞–∂–µ—Ç—Å—è, —á—Ç–æ 0/1 –ø–µ—Ä–µ–≤—ë—Ä–Ω—É—Ç—ã).
- `--print-matrix`: –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–æ –ø–µ—á–∞—Ç–∞—Ç—å –º–∞—Ç—Ä–∏—Ü—É 7√ó7 –≤ —É–¥–æ–±–Ω–æ–º –≤–∏–¥–µ.
- `--style {blocks,ascii,numbers}`: —Å—Ç–∏–ª—å –≤–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏–∏ –º–∞—Ç—Ä–∏—Ü—ã.
- `--save-original PATH`: —Å–æ—Ö—Ä–∞–Ω–∏—Ç—å –∏—Å—Ö–æ–¥–Ω–æ–µ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ 28√ó28 –≤ PNG –ø–æ —É–∫–∞–∑–∞–Ω–Ω–æ–º—É –ø—É—Ç–∏.
 - `--save-raw PATH`: —Å–æ—Ö—Ä–∞–Ω–∏—Ç—å –∏—Å—Ö–æ–¥–Ω–æ–µ –∏—Å—Ö–æ–¥–Ω–æ–µ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ (–Ω–∞–ø—Ä–∏–º–µ—Ä, PNG —ç–º–æ–¥–∑–∏) –±–µ–∑ –∏–∑–º–µ–Ω–µ–Ω–∏–π.
 - `--source {emoji,quickdraw}` (–ø–æ —É–º–æ–ª—á–∞–Ω–∏—é `emoji`): –∏—Å—Ç–æ—á–Ω–∏–∫ –¥–∞–Ω–Ω—ã—Ö.
 - `--emoji-set {twemoji,noto}` (–ø–æ —É–º–æ–ª—á–∞–Ω–∏—é `twemoji`): –Ω–∞–±–æ—Ä —ç–º–æ–¥–∑–∏ –¥–ª—è –∑–∞–≥—Ä—É–∑–∫–∏.
 - `--custom-emoji-url URL` (–º–æ–∂–Ω–æ –ø–æ–≤—Ç–æ—Ä—è—Ç—å): –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å —Å–ø–∏—Å–æ–∫ –∫–∞—Å—Ç–æ–º–Ω—ã—Ö —ç–º–æ–¥–∑–∏ (–∏–∑ —ç—Ç–æ–≥–æ —Å–ø–∏—Å–∫–∞ –≤—ã–±–∏—Ä–∞–µ—Ç—Å—è —Å–ª—É—á–∞–π–Ω–æ).
 - `--method {avg,max,fraction}` (–ø–æ —É–º–æ–ª—á–∞–Ω–∏—é `avg`):
   - `avg` ‚Äî —É—Å—Ä–µ–¥–Ω–µ–Ω–∏–µ –ø–æ –ø–ª–æ—â–∞–¥–∏ (–∫–∞–∫ —Ä–∞–Ω—å—à–µ), –∑–∞—Ç–µ–º –ø–æ—Ä–æ–≥.
   - `max` ‚Äî –µ—Å–ª–∏ –≤ ¬´—è—á–µ–π–∫–µ¬ª –µ—Å—Ç—å —Ö–æ—Ç—å –æ–¥–∏–Ω —à—Ç—Ä–∏—Ö, –ø–∏–∫—Å–µ–ª—å=1 (–ª—É—á—à–µ —Å–æ—Ö—Ä–∞–Ω—è–µ—Ç —Ç–æ–Ω–∫–∏–µ –ª–∏–Ω–∏–∏ –ø—Ä–∏ –º–∞–ª–µ–Ω—å–∫–∏—Ö —Ä–∞–∑–º–µ—Ä–∞—Ö).
   - `fraction` ‚Äî –ø–∏–∫—Å–µ–ª—å=1, –µ—Å–ª–∏ –¥–æ–ª—è —à—Ç—Ä–∏—Ö–æ–≤ –≤ —è—á–µ–π–∫–µ ‚â• `--fraction`.
 - `--fraction FLOAT` (–ø–æ —É–º–æ–ª—á–∞–Ω–∏—é `0.2`): –ø–æ—Ä–æ–≥ –¥–æ–ª–∏ –¥–ª—è `method=fraction` (0..1).

## –¢–µ—Ö–Ω–∏—á–µ—Å–∫–∏–µ –¥–µ—Ç–∞–ª–∏

- –ú–æ–¥—É–ª—å `quickdraw_fetcher.py` –≤—ã–±–∏—Ä–∞–µ—Ç –∫–∞—Ç–µ–≥–æ—Ä–∏—é –∏ –∑–∞–±–∏—Ä–∞–µ—Ç .npy —Å –º–∞—Å—Å–∏–≤–æ–º —Ñ–æ—Ä–º–∞—Ç–∞ `(N, 784)` –∏ –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç —Å–ª—É—á–∞–π–Ω–æ–µ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ `(28, 28)` –∏ –º–µ—Ç–∫—É.
- –ú–æ–¥—É–ª—å `processor.py` —É–º–µ–Ω—å—à–∞–µ—Ç –¥–æ `7x7` –º–µ—Ç–æ–¥–æ–º `BOX` (—Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –ø—Ä–∏—Å—É—Ç—Å—Ç–≤–∏—è —à—Ç—Ä–∏—Ö–æ–≤) –∏ –±–∏–Ω–æ—Ä–∏–∑—É–µ—Ç –º–∞—Ç—Ä–∏—Ü—É –¥–æ 0/1.
